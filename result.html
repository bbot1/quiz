<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>퀴즈 결과</title>
  <link rel="stylesheet" href="style.css">
  <style>
    #result-container {
      max-width: 800px;
      margin: 40px auto;
      padding: 20px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    #summary {
      font-size: 16px;
      margin: 10px 0 20px;
      text-align: center;
    }
    .result-section {
      margin-bottom: 30px;
    }
    .result-section h2 {
      font-size: 18px;
      border-bottom: 1px solid #ccc;
      padding-bottom: 4px;
    }
    .item {
      margin: 12px 0;
    }
    .index {
      font-weight: bold;
      margin-right: 8px;
    }
    .choice-button, .group-input, .choice-display {
      cursor: default;
    }
    .choice-button {
      margin: 6px 0;
      padding: 10px;
      width: 100%;
      text-align: left;
      border: 1px solid #007bff;
      background: #fff;
      border-radius: 4px;
    }
    .choice-button.correct {
      border-color: #28a745;
      background: #e6ffed;
    }
    .choice-button.wrong {
      border-color: #dc3545;
      background: #ffe6e6;
    }
    .group-ui {
      display: flex;
      gap: 20px;
      margin: 8px 0;
    }
    .group-left p {
      margin: 6px 0;
      font-weight: bold;
    }
    .group-right div {
      display: flex;
      align-items: center;
      margin: 6px 0;
    }
    .group-input {
      width: 30px;
      padding: 4px;
      margin-right: 8px;
      text-align: center;
      border: 1px solid #ccc;
      background: #f9f9f9;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div id="result-container">
    <h1>퀴즈 결과</h1>
    <div id="summary"></div>

    <div id="correctList" class="result-section">
      <h2>✅ 맞춘 문제</h2>
    </div>
    <div id="wrongList" class="result-section">
      <h2>❌ 틀린 문제</h2>
    </div>

    <div style="text-align:right; margin-top:20px;">
      <button onclick="location.href='index.html'">처음으로</button>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const results = JSON.parse(localStorage.getItem('quizResults') || '[]');
      // 시도한 문제만 필터링 (user !== null)
      const attempted = results.filter(r => r.user !== null && r.user !== undefined);

      // 맞춘/틀린 계산
      let correctCount = 0;
      let wrongCount = 0;
      const correctListEl = document.getElementById('correctList');
      const wrongListEl = document.getElementById('wrongList');

      attempted.forEach(r => {
        let isCorrect = false;
        if (r.type === 'multiple' || r.type === 'sequence') {
          isCorrect = Number(r.user) === Number(r.answer);
        } else if (r.type === 'short') {
          isCorrect = r.answer.includes(r.user);
        } else if (r.type === 'ox') {
          isCorrect = r.user === r.answer;
        } else if (r.type === 'group' || r.type === 'image-blank') {
          isCorrect = JSON.stringify(r.user) === JSON.stringify(r.answer);
        }
        // 아이템 생성
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `
          <span class="index">${r.index}.</span>
          <span>${r.question}</span>
          <div class="choice-display">내 답: ${JSON.stringify(r.user)}</div>
          <div class="choice-display">정답: ${JSON.stringify(r.answer)}</div>
        `;
        if (isCorrect) {
          correctCount++;
          correctListEl.appendChild(div);
        } else {
          wrongCount++;
          wrongListEl.appendChild(div);
        }
      });

      // 요약 표시
      document.getElementById('summary').innerHTML =
        `맞춘: <strong>${correctCount}</strong>  |  틀린: <strong>${wrongCount}</strong>  |  전체: <strong>${attempted.length}</strong>`;
    });
  </script>
</body>
</html>
